2021-06-06 14:56:44,205 p=1608296 u=snelson n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2021-06-06 14:56:44,520 p=1608296 u=snelson n=ansible | PLAY [localhost] ***************************************************************************************************************************************************************************************
2021-06-06 14:56:44,571 p=1608296 u=snelson n=ansible | TASK [Running Cluster EC2 Role name=ec2] ***************************************************************************************************************************************************************
2021-06-06 14:56:44,741 p=1608296 u=snelson n=ansible | TASK [ec2 : Create EC2 VPC name={{ vpc_name }}, cidr_block={{ vpc_cidr }}, region={{ region_name }}, state=present, aws_access_key={{ access_key }}, aws_secret_key={{ secret_key }}, security_token={{ security_token }}] ***
2021-06-06 14:56:44,816 p=1608296 u=snelson n=ansible | fatal: [localhost]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'access_key' is undefined\n\nThe error appears to be in '/home/snelson/sl-infraop/ansible/roles/ec2/tasks/main.yml': line 4, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Create EC2 VPC\n  ^ here\n"}
2021-06-06 14:56:44,819 p=1608296 u=snelson n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************
2021-06-06 14:56:44,819 p=1608296 u=snelson n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2021-06-06 14:58:04,723 p=1608915 u=snelson n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2021-06-06 14:58:04,986 p=1608915 u=snelson n=ansible | PLAY [localhost] ***************************************************************************************************************************************************************************************
2021-06-06 14:58:05,005 p=1608915 u=snelson n=ansible | TASK [Running Cluster EC2 Role name=ec2] ***************************************************************************************************************************************************************
2021-06-06 14:58:05,124 p=1608915 u=snelson n=ansible | TASK [ec2 : Create EC2 VPC name={{ vpc_name }}, cidr_block={{ vpc_cidr }}, region={{ region_name }}, state=present, aws_access_key={{ access_key }}, aws_secret_key={{ secret_key }}, security_token={{ security_token }}] ***
2021-06-06 14:58:05,248 p=1608915 u=snelson n=ansible | fatal: [localhost]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'access_key' is undefined\n\nThe error appears to be in '/home/snelson/sl-infraop/ansible/roles/ec2/tasks/main.yml': line 3, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Create EC2 VPC\n  ^ here\n"}
2021-06-06 14:58:05,254 p=1608915 u=snelson n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************
2021-06-06 14:58:05,254 p=1608915 u=snelson n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2021-06-06 14:58:29,022 p=1609111 u=snelson n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2021-06-06 14:58:29,275 p=1609111 u=snelson n=ansible | [WARNING]: Could not match supplied host pattern, ignoring: master

2021-06-06 14:58:29,276 p=1609111 u=snelson n=ansible | [WARNING]: Could not match supplied host pattern, ignoring: workers

2021-06-06 14:58:29,277 p=1609111 u=snelson n=ansible | playbook: playbook.yml
2021-06-06 14:59:48,465 p=1609727 u=snelson n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2021-06-06 14:59:48,750 p=1609727 u=snelson n=ansible | PLAY [localhost] ***************************************************************************************************************************************************************************************
2021-06-06 14:59:48,770 p=1609727 u=snelson n=ansible | TASK [Running Cluster EC2 Role name=ec2] ***************************************************************************************************************************************************************
2021-06-06 14:59:48,861 p=1609727 u=snelson n=ansible | TASK [ec2 : Create EC2 VPC name={{ vpc_name }}, cidr_block={{ vpc_cidr }}, region={{ region_name }}, state=present, aws_access_key={{ access_key }}, aws_secret_key={{ secret_key }}, security_token={{ security_token }}] ***
2021-06-06 14:59:48,935 p=1609727 u=snelson n=ansible | fatal: [localhost]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'access_key' is undefined\n\nThe error appears to be in '/home/snelson/sl-infraop/ansible/roles/ec2/tasks/main.yml': line 3, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Create EC2 VPC\n  ^ here\n"}
2021-06-06 14:59:48,937 p=1609727 u=snelson n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************
2021-06-06 14:59:48,938 p=1609727 u=snelson n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2021-06-06 15:01:05,751 p=1610282 u=snelson n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2021-06-06 15:01:10,261 p=1610282 u=snelson n=ansible | PLAY [localhost] ***************************************************************************************************************************************************************************************
2021-06-06 15:01:10,281 p=1610282 u=snelson n=ansible | TASK [Running Cluster EC2 Role name=ec2] ***************************************************************************************************************************************************************
2021-06-06 15:01:10,394 p=1610282 u=snelson n=ansible | TASK [ec2 : Delete EC2 private key on AWS name={{ ec2_keypair_name }}, state=absent, region={{ region_name }}, aws_access_key={{ access_key }}, aws_secret_key={{ secret_key }}, security_token={{ security_token }}] ***
2021-06-06 15:01:12,513 p=1610282 u=snelson n=ansible |  [ERROR]: User interrupted execution

2021-06-06 15:01:15,144 p=1610362 u=snelson n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2021-06-06 15:01:15,410 p=1610362 u=snelson n=ansible | PLAY [localhost] ***************************************************************************************************************************************************************************************
2021-06-06 15:01:15,430 p=1610362 u=snelson n=ansible | TASK [Running Cluster EC2 Role name=ec2] ***************************************************************************************************************************************************************
2021-06-06 15:01:15,523 p=1610362 u=snelson n=ansible | TASK [ec2 : Delete EC2 private key on AWS name={{ ec2_keypair_name }}, state=absent, region={{ region_name }}, aws_access_key={{ access_key }}, aws_secret_key={{ secret_key }}, security_token={{ security_token }}] ***
2021-06-06 15:01:15,593 p=1610362 u=snelson n=ansible | fatal: [localhost]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'access_key' is undefined\n\nThe error appears to be in '/home/snelson/sl-infraop/ansible/roles/ec2/tasks/main.yml': line 3, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: Delete EC2 private key on AWS\n  ^ here\n"}
2021-06-06 15:01:15,595 p=1610362 u=snelson n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************
2021-06-06 15:01:15,595 p=1610362 u=snelson n=ansible | localhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2021-06-06 15:17:51,963 p=1617811 u=snelson n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2021-06-06 15:17:52,265 p=1617811 u=snelson n=ansible | PLAY [localhost] ***************************************************************************************************************************************************************************************
2021-06-06 15:17:52,298 p=1617811 u=snelson n=ansible | TASK [Running Cluster EC2 Role name=ec2] ***************************************************************************************************************************************************************
2021-06-06 15:17:52,413 p=1617811 u=snelson n=ansible | TASK [ec2 : Create EC2 VPC name={{ vpc_name }}, cidr_block={{ vpc_cidr }}, region={{ region_name }}, state=present, aws_access_key={{ access_key }}, aws_secret_key={{ secret_key }}, security_token={{ security_token }}] ***
2021-06-06 15:17:55,763 p=1617811 u=snelson n=ansible | changed: [localhost]
2021-06-06 15:17:55,766 p=1617811 u=snelson n=ansible | TASK [ec2 : Set vpc_id vpc_id={{ create_vpc.vpc.id }}] *************************************************************************************************************************************************
2021-06-06 15:17:55,832 p=1617811 u=snelson n=ansible | ok: [localhost]
2021-06-06 15:17:55,842 p=1617811 u=snelson n=ansible | TASK [ec2 : Associate subnet to the VPC state=present, vpc_id={{ vpc_id }}, region={{ region_name }}, cidr={{ subnet_cidr }}, map_public=True, resource_tags={'Name': '{{ subnet_name }}'}, aws_access_key={{ access_key }}, aws_secret_key={{ secret_key }}, security_token={{ security_token }}] ***
2021-06-06 15:17:57,071 p=1617811 u=snelson n=ansible |  [ERROR]: User interrupted execution

2021-06-06 15:20:45,769 p=1619148 u=snelson n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2021-06-06 15:20:46,010 p=1619148 u=snelson n=ansible | ERROR! 'environment' is not a valid attribute for a IncludeRole

The error appears to be in '/home/snelson/sl-infraop/ansible/playbook.yml': line 5, column 7, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

  tasks:
    - name: Running Cluster EC2 Role
      ^ here

2021-06-06 15:21:29,202 p=1619445 u=snelson n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2021-06-06 15:21:29,456 p=1619445 u=snelson n=ansible | PLAY [localhost] ***************************************************************************************************************************************************************************************
2021-06-06 15:21:29,479 p=1619445 u=snelson n=ansible | TASK [Running Cluster EC2 Role name=ec2] ***************************************************************************************************************************************************************
2021-06-06 15:21:29,772 p=1619445 u=snelson n=ansible | TASK [ec2 : Create EC2 VPC name={{ vpc_name }}, cidr_block={{ vpc_cidr }}, region={{ region_name }}, state=present] ************************************************************************************
2021-06-06 15:21:31,891 p=1619445 u=snelson n=ansible | ok: [localhost]
2021-06-06 15:21:31,897 p=1619445 u=snelson n=ansible | TASK [ec2 : Set vpc_id vpc_id={{ create_vpc.vpc.id }}] *************************************************************************************************************************************************
2021-06-06 15:21:31,963 p=1619445 u=snelson n=ansible | ok: [localhost]
2021-06-06 15:21:31,966 p=1619445 u=snelson n=ansible | TASK [ec2 : Associate subnet to the VPC state=present, vpc_id={{ vpc_id }}, region={{ region_name }}, cidr={{ subnet_cidr }}, map_public=True, resource_tags={'Name': '{{ subnet_name }}'}, aws_access_key={{ access_key }}, aws_secret_key={{ secret_key }}, security_token={{ security_token }}] ***
2021-06-06 15:21:33,861 p=1619445 u=snelson n=ansible | changed: [localhost]
2021-06-06 15:21:33,865 p=1619445 u=snelson n=ansible | TASK [ec2 : Set vpc_subnet_id vpc_subnet_id={{ create_subnet.subnet.id }}] *****************************************************************************************************************************
2021-06-06 15:21:33,941 p=1619445 u=snelson n=ansible | ok: [localhost]
2021-06-06 15:21:33,945 p=1619445 u=snelson n=ansible | TASK [ec2 : Create IGW state=present, vpc_id={{ vpc_id }}, region={{ region_name }}, tags={'Name': '{{ igw_name }}'}, aws_access_key={{ access_key }}, aws_secret_key={{ secret_key }}, security_token={{ security_token }}] ***
2021-06-06 15:21:34,944 p=1619445 u=snelson n=ansible |  [ERROR]: User interrupted execution

2021-06-06 15:25:40,314 p=1621292 u=snelson n=ansible | [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

2021-06-06 15:25:40,606 p=1621292 u=snelson n=ansible | PLAY [localhost] ***************************************************************************************************************************************************************************************
2021-06-06 15:25:40,639 p=1621292 u=snelson n=ansible | TASK [Running Cluster EC2 Role name=ec2] ***************************************************************************************************************************************************************
2021-06-06 15:25:40,793 p=1621292 u=snelson n=ansible | TASK [ec2 : Create EC2 VPC name={{ vpc_name }}, cidr_block={{ vpc_cidr }}, region={{ region_name }}, state=present] ************************************************************************************
2021-06-06 15:25:43,092 p=1621292 u=snelson n=ansible | ok: [localhost]
2021-06-06 15:25:43,096 p=1621292 u=snelson n=ansible | TASK [ec2 : Set vpc_id vpc_id={{ create_vpc.vpc.id }}] *************************************************************************************************************************************************
2021-06-06 15:25:43,161 p=1621292 u=snelson n=ansible | ok: [localhost]
2021-06-06 15:25:43,166 p=1621292 u=snelson n=ansible | TASK [ec2 : Associate subnet to the VPC state=present, vpc_id={{ vpc_id }}, region={{ region_name }}, cidr={{ subnet_cidr }}, map_public=True, resource_tags={'Name': '{{ subnet_name }}'}] ************
2021-06-06 15:25:44,501 p=1621292 u=snelson n=ansible | ok: [localhost]
2021-06-06 15:25:44,505 p=1621292 u=snelson n=ansible | TASK [ec2 : Set vpc_subnet_id vpc_subnet_id={{ create_subnet.subnet.id }}] *****************************************************************************************************************************
2021-06-06 15:25:44,572 p=1621292 u=snelson n=ansible | ok: [localhost]
2021-06-06 15:25:44,576 p=1621292 u=snelson n=ansible | TASK [ec2 : Create IGW state=present, vpc_id={{ vpc_id }}, region={{ region_name }}, tags={'Name': '{{ igw_name }}'}] **********************************************************************************
2021-06-06 15:25:46,307 p=1621292 u=snelson n=ansible | changed: [localhost]
2021-06-06 15:25:46,311 p=1621292 u=snelson n=ansible | TASK [ec2 : Route IGW vpc_id={{ vpc_id }}, region={{ region_name }}, subnets=['{{ vpc_subnet_id }}'], routes=[{'dest': '0.0.0.0/0', 'gateway_id': '{{ igw.gateway_id }}'}], tags={'Name': 'Route IGW'}] ***
2021-06-06 15:25:53,950 p=1621292 u=snelson n=ansible | changed: [localhost]
2021-06-06 15:25:53,954 p=1621292 u=snelson n=ansible | TASK [ec2 : Create EC2 Security Group name={{ sg_name }}, description=DMZ Security Group, vpc_id={{ vpc_id }}, region={{ region_name }}, state=present, rules=[{'proto': 'all', 'group_name': '{{ sg_name }}'}, {'proto': 'tcp', 'from_port': 80, 'to_port': 80, 'cidr_ip': '0.0.0.0/0'}, {'proto': 'tcp', 'from_port': 22, 'to_port': 22, 'cidr_ip': '0.0.0.0/0'}]] ***
2021-06-06 15:27:01,559 p=1621292 u=snelson n=ansible | [WARNING]: Ran out of time waiting for sg-09b8e7e0c4b9d894e IpPermissions. Current: {Rule(port_range=(None, None), protocol='-1', target=('090326560339', 'sg-09b8e7e0c4b9d894e', None),
target_type='group', description=None), Rule(port_range=(80, 80), protocol='tcp', target='0.0.0.0/0', target_type='ipv4', description=None), Rule(port_range=(22, 22), protocol='tcp',
target='0.0.0.0/0', target_type='ipv4', description=None)}, Desired: [Rule(port_range=(None, None), protocol='-1', target='sg-09b8e7e0c4b9d894e', target_type='group', description=None),
Rule(port_range=(80, 80), protocol='tcp', target='0.0.0.0/0', target_type='ipv4', description=None), Rule(port_range=(22, 22), protocol='tcp', target='0.0.0.0/0', target_type='ipv4',
description=None)]

2021-06-06 15:27:01,560 p=1621292 u=snelson n=ansible | changed: [localhost]
2021-06-06 15:27:01,564 p=1621292 u=snelson n=ansible | TASK [ec2 : Set Security Group Id sg_id={{ security_group.group_id }}] *********************************************************************************************************************************
2021-06-06 15:27:01,634 p=1621292 u=snelson n=ansible | ok: [localhost]
2021-06-06 15:27:01,638 p=1621292 u=snelson n=ansible | TASK [ec2 : Add EC2 Cluster Master key_name={{ ec2_keypair_name }}, instance_type={{ instance_flavour }}, image={{ ami_id }}, wait=True, instance_tags={'Name': 'master'}, region={{ region_name }}, group={{ sg_name }}, vpc_subnet_id={{ vpc_subnet_id }}, count_tag={'Name': 'master'}, exact_count=1] ***
2021-06-06 15:27:35,758 p=1621292 u=snelson n=ansible | changed: [localhost]
2021-06-06 15:27:35,763 p=1621292 u=snelson n=ansible | TASK [ec2 : Allocate Master Elastic IP state=present, device_id={{ master.tagged_instances[0].id }}, region={{ region_name }}, in_vpc=True, reuse_existing_ip_allowed=True] ****************************
2021-06-06 15:27:38,292 p=1621292 u=snelson n=ansible | changed: [localhost]
2021-06-06 15:27:38,298 p=1621292 u=snelson n=ansible | TASK [ec2 : Add master to master group hostname={{ eip.public_ip }}, groupname=master] *****************************************************************************************************************
2021-06-06 15:27:38,358 p=1621292 u=snelson n=ansible | changed: [localhost]
2021-06-06 15:27:38,362 p=1621292 u=snelson n=ansible | TASK [ec2 : Add EC2 Cluster Worker Nodes key_name={{ ec2_keypair_name }}, instance_type={{ instance_flavour }}, image={{ ami_id }}, wait=True, instance_tags={'Name': 'worker-{{ item }}'}, region={{ region_name }}, group={{ sg_name }}, vpc_subnet_id={{ vpc_subnet_id }}, count_tag={'Name': 'worker-{{ item }}'}, exact_count=1] ***
2021-06-06 15:28:07,085 p=1621292 u=snelson n=ansible | changed: [localhost] => (item=1)
2021-06-06 15:28:35,777 p=1621292 u=snelson n=ansible | changed: [localhost] => (item=2)
2021-06-06 15:28:35,782 p=1621292 u=snelson n=ansible | TASK [ec2 : Add Cluster Worker Nodes to Worker Group groupname=workers, hostname={{ item.tagged_instances[0].public_ip }}] *****************************************************************************
2021-06-06 15:28:35,858 p=1621292 u=snelson n=ansible | changed: [localhost] => (item={'changed': True, 'instance_ids': ['i-0e91eb4213b3e424a'], 'instances': [{'id': 'i-0e91eb4213b3e424a', 'ami_launch_index': '0', 'private_ip': '10.10.0.49', 'private_dns_name': 'ip-10-10-0-49.ec2.internal', 'public_ip': '34.205.43.133', 'dns_name': 'ec2-34-205-43-133.compute-1.amazonaws.com', 'public_dns_name': 'ec2-34-205-43-133.compute-1.amazonaws.com', 'state_code': 16, 'architecture': 'x86_64', 'image_id': 'ami-0d5eff06f840b45e9', 'key_name': 'ec2_keypair', 'placement': 'us-east-1b', 'region': 'us-east-1', 'kernel': None, 'ramdisk': None, 'launch_time': '2021-06-06T15:27:40.000Z', 'instance_type': 't2.micro', 'root_device_type': 'ebs', 'root_device_name': '/dev/xvda', 'state': 'running', 'hypervisor': 'xen', 'tags': {'Name': 'worker-1'}, 'groups': {'sg-09b8e7e0c4b9d894e': 'Cluster Web DMZ'}, 'virtualization_type': 'hvm', 'ebs_optimized': False, 'block_device_mapping': {'/dev/xvda': {'status': 'attached', 'volume_id': 'vol-0ab250133e3fbebe7', 'delete_on_termination': True}}, 'tenancy': 'default'}], 'tagged_instances': [{'id': 'i-0e91eb4213b3e424a', 'ami_launch_index': '0', 'private_ip': '10.10.0.49', 'private_dns_name': 'ip-10-10-0-49.ec2.internal', 'public_ip': '34.205.43.133', 'dns_name': 'ec2-34-205-43-133.compute-1.amazonaws.com', 'public_dns_name': 'ec2-34-205-43-133.compute-1.amazonaws.com', 'state_code': 16, 'architecture': 'x86_64', 'image_id': 'ami-0d5eff06f840b45e9', 'key_name': 'ec2_keypair', 'placement': 'us-east-1b', 'region': 'us-east-1', 'kernel': None, 'ramdisk': None, 'launch_time': '2021-06-06T15:27:40.000Z', 'instance_type': 't2.micro', 'root_device_type': 'ebs', 'root_device_name': '/dev/xvda', 'state': 'running', 'hypervisor': 'xen', 'tags': {'Name': 'worker-1'}, 'groups': {'sg-09b8e7e0c4b9d894e': 'Cluster Web DMZ'}, 'virtualization_type': 'hvm', 'ebs_optimized': False, 'block_device_mapping': {'/dev/xvda': {'status': 'attached', 'volume_id': 'vol-0ab250133e3fbebe7', 'delete_on_termination': True}}, 'tenancy': 'default'}], 'invocation': {'module_args': {'key_name': 'ec2_keypair', 'instance_type': 't2.micro', 'image': 'ami-0d5eff06f840b45e9', 'wait': True, 'instance_tags': {'Name': 'worker-1'}, 'region': 'us-east-1', 'group': ['Cluster Web DMZ'], 'vpc_subnet_id': 'subnet-0ef6a7d6d7d183911', 'count_tag': {'Name': 'worker-1'}, 'exact_count': 1, 'debug_botocore_endpoint_logs': False, 'validate_certs': True, 'spot_type': 'one-time', 'count': 1, 'monitoring': False, 'wait_timeout': 300, 'spot_wait_timeout': 600, 'state': 'present', 'instance_initiated_shutdown_behavior': 'stop', 'ebs_optimized': False, 'tenancy': 'default', 'ec2_url': None, 'aws_secret_key': None, 'aws_access_key': None, 'security_token': None, 'profile': None, 'id': None, 'group_id': None, 'zone': None, 'spot_price': None, 'spot_launch_group': None, 'kernel': None, 'ramdisk': None, 'placement_group': None, 'user_data': None, 'assign_public_ip': None, 'private_ip': None, 'instance_profile_name': None, 'instance_ids': None, 'source_dest_check': None, 'termination_protection': None, 'volumes': None, 'network_interfaces': None}}, 'failed': False, 'item': '1', 'ansible_loop_var': 'item'})
2021-06-06 15:28:35,869 p=1621292 u=snelson n=ansible | changed: [localhost] => (item={'changed': True, 'instance_ids': ['i-02ca2fe7c04c0cd1d'], 'instances': [{'id': 'i-02ca2fe7c04c0cd1d', 'ami_launch_index': '0', 'private_ip': '10.10.0.16', 'private_dns_name': 'ip-10-10-0-16.ec2.internal', 'public_ip': '100.27.34.80', 'dns_name': 'ec2-100-27-34-80.compute-1.amazonaws.com', 'public_dns_name': 'ec2-100-27-34-80.compute-1.amazonaws.com', 'state_code': 16, 'architecture': 'x86_64', 'image_id': 'ami-0d5eff06f840b45e9', 'key_name': 'ec2_keypair', 'placement': 'us-east-1b', 'region': 'us-east-1', 'kernel': None, 'ramdisk': None, 'launch_time': '2021-06-06T15:28:09.000Z', 'instance_type': 't2.micro', 'root_device_type': 'ebs', 'root_device_name': '/dev/xvda', 'state': 'running', 'hypervisor': 'xen', 'tags': {'Name': 'worker-2'}, 'groups': {'sg-09b8e7e0c4b9d894e': 'Cluster Web DMZ'}, 'virtualization_type': 'hvm', 'ebs_optimized': False, 'block_device_mapping': {'/dev/xvda': {'status': 'attached', 'volume_id': 'vol-052b0be49ecde1852', 'delete_on_termination': True}}, 'tenancy': 'default'}], 'tagged_instances': [{'id': 'i-02ca2fe7c04c0cd1d', 'ami_launch_index': '0', 'private_ip': '10.10.0.16', 'private_dns_name': 'ip-10-10-0-16.ec2.internal', 'public_ip': '100.27.34.80', 'dns_name': 'ec2-100-27-34-80.compute-1.amazonaws.com', 'public_dns_name': 'ec2-100-27-34-80.compute-1.amazonaws.com', 'state_code': 16, 'architecture': 'x86_64', 'image_id': 'ami-0d5eff06f840b45e9', 'key_name': 'ec2_keypair', 'placement': 'us-east-1b', 'region': 'us-east-1', 'kernel': None, 'ramdisk': None, 'launch_time': '2021-06-06T15:28:09.000Z', 'instance_type': 't2.micro', 'root_device_type': 'ebs', 'root_device_name': '/dev/xvda', 'state': 'running', 'hypervisor': 'xen', 'tags': {'Name': 'worker-2'}, 'groups': {'sg-09b8e7e0c4b9d894e': 'Cluster Web DMZ'}, 'virtualization_type': 'hvm', 'ebs_optimized': False, 'block_device_mapping': {'/dev/xvda': {'status': 'attached', 'volume_id': 'vol-052b0be49ecde1852', 'delete_on_termination': True}}, 'tenancy': 'default'}], 'invocation': {'module_args': {'key_name': 'ec2_keypair', 'instance_type': 't2.micro', 'image': 'ami-0d5eff06f840b45e9', 'wait': True, 'instance_tags': {'Name': 'worker-2'}, 'region': 'us-east-1', 'group': ['Cluster Web DMZ'], 'vpc_subnet_id': 'subnet-0ef6a7d6d7d183911', 'count_tag': {'Name': 'worker-2'}, 'exact_count': 1, 'debug_botocore_endpoint_logs': False, 'validate_certs': True, 'spot_type': 'one-time', 'count': 1, 'monitoring': False, 'wait_timeout': 300, 'spot_wait_timeout': 600, 'state': 'present', 'instance_initiated_shutdown_behavior': 'stop', 'ebs_optimized': False, 'tenancy': 'default', 'ec2_url': None, 'aws_secret_key': None, 'aws_access_key': None, 'security_token': None, 'profile': None, 'id': None, 'group_id': None, 'zone': None, 'spot_price': None, 'spot_launch_group': None, 'kernel': None, 'ramdisk': None, 'placement_group': None, 'user_data': None, 'assign_public_ip': None, 'private_ip': None, 'instance_profile_name': None, 'instance_ids': None, 'source_dest_check': None, 'termination_protection': None, 'volumes': None, 'network_interfaces': None}}, 'failed': False, 'item': '2', 'ansible_loop_var': 'item'})
2021-06-06 15:28:35,874 p=1621292 u=snelson n=ansible | TASK [ec2 : Create EC2 Load Balancer name={{ lb_name }}, state=present, region={{ region_name }}, subnets={{ vpc_subnet_id }}, listeners=[{'protocol': 'http', 'load_balancer_port': 80, 'instance_port': '{{lb_cluster_frontend_port}}'}], scheme=internet-facing, security_group_names={{ sg_name }}, health_check={'ping_protocol': 'http', 'ping_port': '{{ lb_cluster_frontend_port }}', 'ping_path': '/', 'response_timeout': 5, 'interval': 30, 'unhealthy_threshold': 2, 'healthy_threshold': 2}] ***
2021-06-06 15:28:38,449 p=1621292 u=snelson n=ansible | changed: [localhost]
2021-06-06 15:28:38,454 p=1621292 u=snelson n=ansible | TASK [ec2 : Add servers to Load Balancer state=present, instance_id={{ item.tagged_instances[0].id }}, ec2_elbs={{ lb_name }}, region={{ region_name }}, wait=False] ***********************************
2021-06-06 15:28:40,054 p=1621292 u=snelson n=ansible | changed: [localhost] => (item={'changed': True, 'instance_ids': ['i-0e91eb4213b3e424a'], 'instances': [{'id': 'i-0e91eb4213b3e424a', 'ami_launch_index': '0', 'private_ip': '10.10.0.49', 'private_dns_name': 'ip-10-10-0-49.ec2.internal', 'public_ip': '34.205.43.133', 'dns_name': 'ec2-34-205-43-133.compute-1.amazonaws.com', 'public_dns_name': 'ec2-34-205-43-133.compute-1.amazonaws.com', 'state_code': 16, 'architecture': 'x86_64', 'image_id': 'ami-0d5eff06f840b45e9', 'key_name': 'ec2_keypair', 'placement': 'us-east-1b', 'region': 'us-east-1', 'kernel': None, 'ramdisk': None, 'launch_time': '2021-06-06T15:27:40.000Z', 'instance_type': 't2.micro', 'root_device_type': 'ebs', 'root_device_name': '/dev/xvda', 'state': 'running', 'hypervisor': 'xen', 'tags': {'Name': 'worker-1'}, 'groups': {'sg-09b8e7e0c4b9d894e': 'Cluster Web DMZ'}, 'virtualization_type': 'hvm', 'ebs_optimized': False, 'block_device_mapping': {'/dev/xvda': {'status': 'attached', 'volume_id': 'vol-0ab250133e3fbebe7', 'delete_on_termination': True}}, 'tenancy': 'default'}], 'tagged_instances': [{'id': 'i-0e91eb4213b3e424a', 'ami_launch_index': '0', 'private_ip': '10.10.0.49', 'private_dns_name': 'ip-10-10-0-49.ec2.internal', 'public_ip': '34.205.43.133', 'dns_name': 'ec2-34-205-43-133.compute-1.amazonaws.com', 'public_dns_name': 'ec2-34-205-43-133.compute-1.amazonaws.com', 'state_code': 16, 'architecture': 'x86_64', 'image_id': 'ami-0d5eff06f840b45e9', 'key_name': 'ec2_keypair', 'placement': 'us-east-1b', 'region': 'us-east-1', 'kernel': None, 'ramdisk': None, 'launch_time': '2021-06-06T15:27:40.000Z', 'instance_type': 't2.micro', 'root_device_type': 'ebs', 'root_device_name': '/dev/xvda', 'state': 'running', 'hypervisor': 'xen', 'tags': {'Name': 'worker-1'}, 'groups': {'sg-09b8e7e0c4b9d894e': 'Cluster Web DMZ'}, 'virtualization_type': 'hvm', 'ebs_optimized': False, 'block_device_mapping': {'/dev/xvda': {'status': 'attached', 'volume_id': 'vol-0ab250133e3fbebe7', 'delete_on_termination': True}}, 'tenancy': 'default'}], 'invocation': {'module_args': {'key_name': 'ec2_keypair', 'instance_type': 't2.micro', 'image': 'ami-0d5eff06f840b45e9', 'wait': True, 'instance_tags': {'Name': 'worker-1'}, 'region': 'us-east-1', 'group': ['Cluster Web DMZ'], 'vpc_subnet_id': 'subnet-0ef6a7d6d7d183911', 'count_tag': {'Name': 'worker-1'}, 'exact_count': 1, 'debug_botocore_endpoint_logs': False, 'validate_certs': True, 'spot_type': 'one-time', 'count': 1, 'monitoring': False, 'wait_timeout': 300, 'spot_wait_timeout': 600, 'state': 'present', 'instance_initiated_shutdown_behavior': 'stop', 'ebs_optimized': False, 'tenancy': 'default', 'ec2_url': None, 'aws_secret_key': None, 'aws_access_key': None, 'security_token': None, 'profile': None, 'id': None, 'group_id': None, 'zone': None, 'spot_price': None, 'spot_launch_group': None, 'kernel': None, 'ramdisk': None, 'placement_group': None, 'user_data': None, 'assign_public_ip': None, 'private_ip': None, 'instance_profile_name': None, 'instance_ids': None, 'source_dest_check': None, 'termination_protection': None, 'volumes': None, 'network_interfaces': None}}, 'failed': False, 'item': '1', 'ansible_loop_var': 'item'})
2021-06-06 15:28:41,236 p=1621292 u=snelson n=ansible | changed: [localhost] => (item={'changed': True, 'instance_ids': ['i-02ca2fe7c04c0cd1d'], 'instances': [{'id': 'i-02ca2fe7c04c0cd1d', 'ami_launch_index': '0', 'private_ip': '10.10.0.16', 'private_dns_name': 'ip-10-10-0-16.ec2.internal', 'public_ip': '100.27.34.80', 'dns_name': 'ec2-100-27-34-80.compute-1.amazonaws.com', 'public_dns_name': 'ec2-100-27-34-80.compute-1.amazonaws.com', 'state_code': 16, 'architecture': 'x86_64', 'image_id': 'ami-0d5eff06f840b45e9', 'key_name': 'ec2_keypair', 'placement': 'us-east-1b', 'region': 'us-east-1', 'kernel': None, 'ramdisk': None, 'launch_time': '2021-06-06T15:28:09.000Z', 'instance_type': 't2.micro', 'root_device_type': 'ebs', 'root_device_name': '/dev/xvda', 'state': 'running', 'hypervisor': 'xen', 'tags': {'Name': 'worker-2'}, 'groups': {'sg-09b8e7e0c4b9d894e': 'Cluster Web DMZ'}, 'virtualization_type': 'hvm', 'ebs_optimized': False, 'block_device_mapping': {'/dev/xvda': {'status': 'attached', 'volume_id': 'vol-052b0be49ecde1852', 'delete_on_termination': True}}, 'tenancy': 'default'}], 'tagged_instances': [{'id': 'i-02ca2fe7c04c0cd1d', 'ami_launch_index': '0', 'private_ip': '10.10.0.16', 'private_dns_name': 'ip-10-10-0-16.ec2.internal', 'public_ip': '100.27.34.80', 'dns_name': 'ec2-100-27-34-80.compute-1.amazonaws.com', 'public_dns_name': 'ec2-100-27-34-80.compute-1.amazonaws.com', 'state_code': 16, 'architecture': 'x86_64', 'image_id': 'ami-0d5eff06f840b45e9', 'key_name': 'ec2_keypair', 'placement': 'us-east-1b', 'region': 'us-east-1', 'kernel': None, 'ramdisk': None, 'launch_time': '2021-06-06T15:28:09.000Z', 'instance_type': 't2.micro', 'root_device_type': 'ebs', 'root_device_name': '/dev/xvda', 'state': 'running', 'hypervisor': 'xen', 'tags': {'Name': 'worker-2'}, 'groups': {'sg-09b8e7e0c4b9d894e': 'Cluster Web DMZ'}, 'virtualization_type': 'hvm', 'ebs_optimized': False, 'block_device_mapping': {'/dev/xvda': {'status': 'attached', 'volume_id': 'vol-052b0be49ecde1852', 'delete_on_termination': True}}, 'tenancy': 'default'}], 'invocation': {'module_args': {'key_name': 'ec2_keypair', 'instance_type': 't2.micro', 'image': 'ami-0d5eff06f840b45e9', 'wait': True, 'instance_tags': {'Name': 'worker-2'}, 'region': 'us-east-1', 'group': ['Cluster Web DMZ'], 'vpc_subnet_id': 'subnet-0ef6a7d6d7d183911', 'count_tag': {'Name': 'worker-2'}, 'exact_count': 1, 'debug_botocore_endpoint_logs': False, 'validate_certs': True, 'spot_type': 'one-time', 'count': 1, 'monitoring': False, 'wait_timeout': 300, 'spot_wait_timeout': 600, 'state': 'present', 'instance_initiated_shutdown_behavior': 'stop', 'ebs_optimized': False, 'tenancy': 'default', 'ec2_url': None, 'aws_secret_key': None, 'aws_access_key': None, 'security_token': None, 'profile': None, 'id': None, 'group_id': None, 'zone': None, 'spot_price': None, 'spot_launch_group': None, 'kernel': None, 'ramdisk': None, 'placement_group': None, 'user_data': None, 'assign_public_ip': None, 'private_ip': None, 'instance_profile_name': None, 'instance_ids': None, 'source_dest_check': None, 'termination_protection': None, 'volumes': None, 'network_interfaces': None}}, 'failed': False, 'item': '2', 'ansible_loop_var': 'item'})
2021-06-06 15:28:41,248 p=1621292 u=snelson n=ansible | PLAY [master] ******************************************************************************************************************************************************************************************
2021-06-06 15:28:41,252 p=1621292 u=snelson n=ansible | TASK [Running Kubernetes Master Role name=master] ******************************************************************************************************************************************************
2021-06-06 15:28:41,358 p=1621292 u=snelson n=ansible | TASK [master : Add kubeadm Repositories on Master name=kube, description=Kubernetes repo, baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-$basearch, enabled=1, gpgcheck=1, gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg] ***
2021-06-06 15:28:42,932 p=1621292 u=snelson n=ansible | [WARNING]: Platform linux on host 52.205.180.27 is using the discovered Python interpreter at /usr/bin/python, but future installation of another Python interpreter could change this. See
https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information.

2021-06-06 15:28:42,932 p=1621292 u=snelson n=ansible | changed: [52.205.180.27]
2021-06-06 15:28:42,937 p=1621292 u=snelson n=ansible | TASK [master : Installing docker & kubeadm on Master name=['docker', 'kubeadm', 'iproute-tc'], state=present] ******************************************************************************************
2021-06-06 15:29:18,740 p=1621292 u=snelson n=ansible | changed: [52.205.180.27]
2021-06-06 15:29:18,745 p=1621292 u=snelson n=ansible | TASK [master : Enabling docker & kubelet on Master name={{ item }}, state=started, enabled=True] *******************************************************************************************************
2021-06-06 15:29:22,911 p=1621292 u=snelson n=ansible | changed: [52.205.180.27] => (item=docker)
2021-06-06 15:29:25,359 p=1621292 u=snelson n=ansible | changed: [52.205.180.27] => (item=kubelet)
2021-06-06 15:29:25,365 p=1621292 u=snelson n=ansible | TASK [master : Pulling the images of k8s master _raw_params=kubeadm config images pull] ****************************************************************************************************************
2021-06-06 15:29:46,551 p=1621292 u=snelson n=ansible | changed: [52.205.180.27]
2021-06-06 15:29:46,556 p=1621292 u=snelson n=ansible | TASK [master : Updating Docker cgroup on Master dest=/etc/docker/daemon.json, content={
"exec-opts": ["native.cgroupdriver=systemd"]
}
] ***************************************************************
2021-06-06 15:29:48,782 p=1621292 u=snelson n=ansible | changed: [52.205.180.27]
2021-06-06 15:29:48,785 p=1621292 u=snelson n=ansible | TASK [master : Restart docker on Master name=docker, state=restarted] **********************************************************************************************************************************
2021-06-06 15:29:50,748 p=1621292 u=snelson n=ansible | changed: [52.205.180.27]
2021-06-06 15:29:50,752 p=1621292 u=snelson n=ansible | TASK [master : Initializing Cluster _raw_params=kubeadm init --pod-network-cidr=10.244.0.0/16 --ignore-preflight-errors=NumCPU --ignore-preflight-errors=Mem] ******************************************
2021-06-06 15:30:14,348 p=1621292 u=snelson n=ansible | changed: [52.205.180.27]
2021-06-06 15:30:14,354 p=1621292 u=snelson n=ansible | TASK [master : Setting up kubectl on Master _raw_params=mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config
] ****************
2021-06-06 15:30:15,543 p=1621292 u=snelson n=ansible | changed: [52.205.180.27]
2021-06-06 15:30:15,547 p=1621292 u=snelson n=ansible | TASK [master : Deploying Weave on Master executable=/bin/bash, _raw_params=sudo kubectl apply -f "https://cloud.weave.works/k8s/net?k8s-version=$(sudo kubectl version | base64 | tr -d '\n')"] ********
2021-06-06 15:30:18,451 p=1621292 u=snelson n=ansible | changed: [52.205.180.27]
2021-06-06 15:30:18,455 p=1621292 u=snelson n=ansible | TASK [master : Creating kubeadm Join Token _raw_params=kubeadm token create  --print-join-command] *****************************************************************************************************
2021-06-06 15:30:19,924 p=1621292 u=snelson n=ansible | changed: [52.205.180.27]
2021-06-06 15:30:19,929 p=1621292 u=snelson n=ansible | TASK [master : Cleaning Caches on RAM _raw_params=echo 3 > /proc/sys/vm/drop_caches] *******************************************************************************************************************
2021-06-06 15:30:20,831 p=1621292 u=snelson n=ansible | changed: [52.205.180.27]
2021-06-06 15:30:20,835 p=1621292 u=snelson n=ansible | PLAY [workers] *****************************************************************************************************************************************************************************************
2021-06-06 15:30:20,841 p=1621292 u=snelson n=ansible | TASK [Running Kubernetes Worker  Role name=worker] *****************************************************************************************************************************************************
2021-06-06 15:30:20,891 p=1621292 u=snelson n=ansible | TASK [worker : Add kubeadm Repositories on Worker Node name=kube, description=Kubernetes repo, baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-$basearch, enabled=1, gpgcheck=1, gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg] ***
2021-06-06 15:30:22,328 p=1621292 u=snelson n=ansible | [WARNING]: Platform linux on host 34.205.43.133 is using the discovered Python interpreter at /usr/bin/python, but future installation of another Python interpreter could change this. See
https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information.

2021-06-06 15:30:22,329 p=1621292 u=snelson n=ansible | changed: [34.205.43.133]
2021-06-06 15:30:22,342 p=1621292 u=snelson n=ansible | [WARNING]: Platform linux on host 100.27.34.80 is using the discovered Python interpreter at /usr/bin/python, but future installation of another Python interpreter could change this. See
https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information.

2021-06-06 15:30:22,342 p=1621292 u=snelson n=ansible | changed: [100.27.34.80]
2021-06-06 15:30:22,347 p=1621292 u=snelson n=ansible | TASK [worker : Installing docker & kubeadm on Worker name=['docker', 'kubeadm', 'iproute-tc'], state=present] ******************************************************************************************
2021-06-06 15:30:57,048 p=1621292 u=snelson n=ansible | changed: [100.27.34.80]
2021-06-06 15:30:57,288 p=1621292 u=snelson n=ansible | changed: [34.205.43.133]
2021-06-06 15:30:57,293 p=1621292 u=snelson n=ansible | TASK [worker : Staring & enabling docker & kubelet on Worker name={{ item }}, state=started, enabled=True] *********************************************************************************************
2021-06-06 15:31:00,986 p=1621292 u=snelson n=ansible | changed: [34.205.43.133] => (item=docker)
2021-06-06 15:31:01,081 p=1621292 u=snelson n=ansible | changed: [100.27.34.80] => (item=docker)
2021-06-06 15:31:03,523 p=1621292 u=snelson n=ansible | changed: [100.27.34.80] => (item=kubelet)
2021-06-06 15:31:03,657 p=1621292 u=snelson n=ansible | changed: [34.205.43.133] => (item=kubelet)
2021-06-06 15:31:03,676 p=1621292 u=snelson n=ansible | TASK [worker : Updating docker cgroup on slave dest=/etc/docker/daemon.json, content={
"exec-opts": ["native.cgroupdriver=systemd"]
}
] ****************************************************************
2021-06-06 15:31:05,272 p=1621292 u=snelson n=ansible | changed: [100.27.34.80]
2021-06-06 15:31:05,313 p=1621292 u=snelson n=ansible | changed: [34.205.43.133]
2021-06-06 15:31:05,317 p=1621292 u=snelson n=ansible | TASK [worker : Restart docker on Worker name=docker, state=restarted] **********************************************************************************************************************************
2021-06-06 15:31:07,145 p=1621292 u=snelson n=ansible | changed: [34.205.43.133]
2021-06-06 15:31:07,179 p=1621292 u=snelson n=ansible | changed: [100.27.34.80]
2021-06-06 15:31:07,183 p=1621292 u=snelson n=ansible | TASK [worker : Updating IP tables on slave dest=/etc/sysctl.d/k8s.conf, content=net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
] ***************************************
2021-06-06 15:31:08,724 p=1621292 u=snelson n=ansible | changed: [34.205.43.133]
2021-06-06 15:31:08,793 p=1621292 u=snelson n=ansible | changed: [100.27.34.80]
2021-06-06 15:31:08,797 p=1621292 u=snelson n=ansible | TASK [worker : Reloading sysctl on Worker _raw_params=sysctl --system] *********************************************************************************************************************************
2021-06-06 15:31:09,571 p=1621292 u=snelson n=ansible | changed: [100.27.34.80]
2021-06-06 15:31:09,575 p=1621292 u=snelson n=ansible | changed: [34.205.43.133]
2021-06-06 15:31:09,579 p=1621292 u=snelson n=ansible | TASK [worker : Joining the cluster _raw_params={{ hostvars[groups['master'][0]]['token']['stdout'] }}] *************************************************************************************************
2021-06-06 15:31:16,549 p=1621292 u=snelson n=ansible | changed: [100.27.34.80]
2021-06-06 15:31:16,571 p=1621292 u=snelson n=ansible | changed: [34.205.43.133]
2021-06-06 15:31:16,576 p=1621292 u=snelson n=ansible | TASK [worker : Cleaning Caches on RAM _raw_params=echo 3 > /proc/sys/vm/drop_caches] *******************************************************************************************************************
2021-06-06 15:31:17,964 p=1621292 u=snelson n=ansible | changed: [34.205.43.133]
2021-06-06 15:31:17,969 p=1621292 u=snelson n=ansible | changed: [100.27.34.80]
2021-06-06 15:31:17,971 p=1621292 u=snelson n=ansible | PLAY RECAP *********************************************************************************************************************************************************************************************
2021-06-06 15:31:17,972 p=1621292 u=snelson n=ansible | 100.27.34.80               : ok=9    changed=9    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2021-06-06 15:31:17,972 p=1621292 u=snelson n=ansible | 34.205.43.133              : ok=9    changed=9    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2021-06-06 15:31:17,972 p=1621292 u=snelson n=ansible | 52.205.180.27              : ok=11   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2021-06-06 15:31:17,972 p=1621292 u=snelson n=ansible | localhost                  : ok=15   changed=10   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
